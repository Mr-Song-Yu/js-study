<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JavaScriptTest</title>
  </head>
  <body>
    <script>
      // JavaScript严格模式
      "use strict";
      // JavaScript小数计算BUG：https://segmentfault.com/a/1190000000324193
      var a = 0.01;
      var b = 0.0003;
      // console.log(accAdd(a,b));
      // console.log(accMul(a,b));
      // console.log(accSub(a,b));
      // console.log(accDiv(a,b));
      var d = []; // typeof d; => object

      /*
       * 加法函数，用来得到精确的加法结果
       * 说明：javascript的加法结果会有误差，在两个浮点数相加的时候会比较明显。这个函数返回较为精确的加法结果。
       * 调用：accAdd(arg1,arg2)
       * 返回值：arg1加上arg2的精确结果
       */
      function accAdd(arg1, arg2) {
        var r1, r2, m, c;
        try {
          r1 = arg1.toString().split(".")[1].length;
        } catch (error) {
          r1 = 0;
        }
        try {
          r2 = arg2.toString().split(".")[1].length;
        } catch (error) {
          r2 = 0;
        }
        c = Math.abs(r1 - r2);
        m = Math.pow(10, Math.max(r1, r2));
        if (c > 0) {
          var cm = Math.pow(10, c);
          if (r1 > r2) {
            arg1 = Number(arg1.toString().replace(".", ""));
            arg2 = Number(arg2.toString().replace(".", "")) * cm;
          } else {
            arg1 = Number(arg1.toString().replace(".", "")) * cm;
            arg2 = Number(arg2.toString().replace(".", ""));
          }
        } else {
          arg1 = Number(arg1.toString().replace(".", ""));
          arg2 = Number(arg2.toString().replace(".", ""));
        }
        return (arg1 + arg2) / m;
      }

      //给Number类型增加一个add方法，调用起来更加方便。
      Number.prototype.add = function (arg) {
        return accAdd(arg, this);
      };

      /*
       * 减法函数，用来得到精确的减法结果
       * 说明：javascript的减法结果会有误差，在两个浮点数相减的时候会比较明显。这个函数返回较为精确的减法结果。
       * 调用：accSub(arg1,arg2)
       * 返回值：arg1加上arg2的精确结果
       */
      function accSub(arg1, arg2) {
        var r1, r2, m, n;
        try {
          r1 = arg1.toString().split(".")[1].length;
        } catch (error) {
          r1 = 0;
        }
        try {
          r2 = arg2.toString().split(".")[1].length;
        } catch (error) {
          r2 = 0;
        }
        m = Math.pow(10, Math.max(r1, r2)); //last modify by deeka //动态控制精度长度
        n = r1 >= r2 ? r1 : r2;
        return ((arg1 * m - arg2 * m) / m).toFixed(n);
      }

      // 给Number类型增加一个mul方法，调用起来更加方便。
      Number.prototype.sub = function (arg) {
        return accMul(arg, this);
      };

      /*
       * 乘法函数，用来得到精确的乘法结果
       * 说明：javascript的乘法结果会有误差，在两个浮点数相乘的时候会比较明显。这个函数返回较为精确的乘法结果。
       * 调用：accMul(arg1,arg2)
       * 返回值：arg1乘以 arg2的精确结果
       */
      function accMul(arg1, arg2) {
        var m = 0,
          s1 = arg1.toString(),
          s2 = arg2.toString();
        try {
          m += s1.split(".")[1].length;
        } catch (error) {}
        try {
          m += s2.split(".")[1].length;
        } catch (error) {}
        return (
          (Number(s1.replace(".", "")) * Number(s2.replace(".", ""))) /
          Math.pow(10, m)
        );
      }

      // 给Number类型增加一个mul方法，调用起来更加方便。
      Number.prototype.mul = function (arg) {
        return accMul(arg, this);
      };

      /*
       * 除法函数，用来得到精确的除法结果
       * 说明：javascript的除法结果会有误差，在两个浮点数相除的时候会比较明显。这个函数返回较为精确的除法结果。
       * 调用：accDiv(arg1,arg2)
       * 返回值：arg1除以arg2的精确结果
       */
      function accDiv(arg1, arg2) {
        var t1 = 0,
          t2 = 0,
          r1,
          r2;
        try {
          t1 = arg1.toString().split(".")[1].length;
        } catch (error) {}
        try {
          t2 = arg2.toString().split(".")[1].length;
        } catch (error) {}
        var answer = (function () {
          r1 = Number(arg1.toString().replace(".", ""));
          r2 = Number(arg2.toString().replace(".", ""));
          return (r1 / r2) * Math.pow(10, t2 - t1);
        })();
        return answer;
      }

      //给Number类型增加一个div方法，调用起来更加方便。
      Number.prototype.div = function (arg) {
        return accDiv(this, arg);
      };

      // 传送门
      function portal(array) {
        const len = array.length;
        var sum = 0,
          k = 0;
        if (array[0] == 0 && len > 1) {
          return "无法传送";
        }
        for (let i = 0; i < len; i = sum) {
          k++;
          sum += array[i];
          if (array[i] == 0 && i != len - 1) {
            return "无法传送";
          }
          if (sum >= len - 1) {
            return k;
          }
        }
        return "无法传送";
      }
    </script>
  </body>
</html>
